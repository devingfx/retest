<!doctype html>
<html lang=en class=content dir=ltr>
<meta charset=UTF-8>
<title>MD docs</title>
<meta name="viewport" content="width=device-width, initial-scale=1">



<main>
	<div class="content container"></div>
</main>

<script type=module>

	
	const DEBUG = /debug/.test( location.search )
	
	const log = DEBUG
					? ss=> (...a)=> console.log( ss.join(''), ...a) || a[0]
					: ss=> o=>o
	
	
	
	const $container = document.querySelector`main .container`
	
	const init = ()=> {
		const pageInfo = {
			title: document.title,
			url: location.href,
		}
		history.replaceState( pageInfo, pageInfo.title, pageInfo.url )
		
		for (const link of document.links) {
		    link.onclick = processLink
		}
		
	}
	
	const loadPage = url=> fetch( url ).then( res=> res.text() )
				.then( src=> ({ title: `DM docs - ${url}`, url, src }) )
				.then( ({ title, url, src })=> {
					history.pushState( { title, url, src }, title, url )
				})
	
	function processLink() {
		//if intra link
		loadPage( this.href )
		return false
	}
	onpopstate = e=> {
		$container.innerHTML = e.state.src
		document.title = e.state.title
	}
	/*window.onhashchange = async e=> {
		
		const url = `/retest/${location.hash.slice(1)}.md`
    
		let src = await loadPage( url )
		
		$container.innerHTML = src
		document.title = `DM docs - ${url}`
	}
	
	!location.hash
		// ? ( location.hash = '#String&DOM&EventojLancilo&SVG' )
		? ( location.hash = '#README' )
		: requestAnimationFrame( onhashchange )
	*/
	window.addEventListener( "load", init, false )
</script>


<main>
	<div class="content container"></div>
</main>

